I"G<p>æ»‘å—éªŒè¯ç æ˜¯ç”Ÿæ´»ä¸­éå¸¸å¸¸è§çš„ä¸€ç§éªŒè¯æ–¹å¼ï¼Œåœ¨çˆ¬è™«è¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°æ”¹æ€ä¹ˆè§£å†³å‘¢ï¼Ÿå½“ç„¶æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨åˆ’è¿‡å»å†æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œä½†æ˜¯è¿™æ ·ä¸ç¬¦åˆæˆ‘ä»¬æ•ˆç‡è‡³ä¸Šçš„åŸåˆ™ã€‚</p>

<h2 id="ç ´è§£æ€è·¯">ç ´è§£æ€è·¯ï¼š</h2>

<p>ä½¿ç”¨seleniumæ¨¡æ‹Ÿäººä¸ºçš„æ“ä½œï¼Œå°†æ»‘å—ç§»åŠ¨åˆ°æŒ‡å®šçš„ä½ç½®ï¼Œç„¶åæ¾å¼€é¼ æ ‡</p>

<h2 id="æ ¸å¿ƒæ€è·¯">æ ¸å¿ƒæ€è·¯ï¼š</h2>

<p>è®¡ç®—å‡ºç§»åŠ¨çš„è·ç¦»</p>

<h3 id="æ€ä¹ˆè®¡ç®—">æ€ä¹ˆè®¡ç®—ï¼š</h3>

<p>æ‰¾åˆ°æ— ç¼ºå£çš„å›¾ç‰‡ï¼Œå¯¹æ¯”ä¸¤å¼ å›¾ç‰‡ï¼Œé€šè¿‡æ±‚å‡ºå›¾ç‰‡ä¸­æ¯ä¸€ä¸ªç‚¹çš„é¢œè‰²çš„RGBå€¼ï¼Œæ‰¾å‡ºç¼ºå£ä½ç½®</p>

<h2 id="å¤§è‡´è¿‡ç¨‹">å¤§è‡´è¿‡ç¨‹ï¼š</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">selenium</span> <span class="k">from</span> <span class="n">webdriver</span>

<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">æ’ä»¶ä½ç½®</span><span class="p">)</span>
<span class="c1"># æœ€å¤§åŒ–çª—å£ï¼Œæ–¹ä¾¿å®šä½å›¾ç‰‡
</span><span class="n">driver</span><span class="p">.</span><span class="n">maxmize_window</span><span class="p">()</span>
<span class="c1"># æˆªå›¾ï¼Œè·å–æœ‰ç¼ºå£çš„å›¾ç‰‡
</span><span class="n">driver</span><span class="p">.</span><span class="n">save_scerrnshot</span><span class="p">(</span><span class="s">'quekou.png'</span><span class="p">)</span>
<span class="c1"># é€šè¿‡è·å–å›¾ç‰‡å…ƒç´ æ¥å‡†å‡†ç¡®å®šä½å›¾ç‰‡
</span><span class="n">ele</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s">'xpathè·¯å¾„'</span><span class="p">)</span>
<span class="c1"># æ ¹æ®å›¾ç‰‡å…ƒç´ ä½ç½®è¿›è¡Œå±€éƒ¨æˆªå›¾
# ç›®çš„ï¼šä¸ºäº†æ–¹ä¾¿å¯¹æ¯”RGBå€¼ï¼Œéœ€è¦å°†æœ€å·¦è¾¹çš„æ‹¼å›¾å—æˆªæ‰ï¼Œä»¥å…å¯¹åé¢çš„å¯¹æ¯”é€ æˆå¹²æ‰°
</span><span class="n">left</span> <span class="o">=</span> <span class="n">ele</span><span class="p">.</span><span class="n">location</span><span class="p">[</span><span class="s">'x'</span><span class="p">]</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">ele</span><span class="p">.</span><span class="n">location</span><span class="p">[</span><span class="s">'x'</span><span class="p">]</span> <span class="o">+</span> <span class="n">ele</span><span class="p">.</span><span class="n">size</span><span class="p">[</span><span class="s">'width'</span><span class="p">]</span>
<span class="n">top</span> <span class="o">=</span> <span class="n">ele</span><span class="p">.</span><span class="n">location</span><span class="p">[</span><span class="s">'y'</span><span class="p">]</span>
<span class="n">bottom</span> <span class="o">=</span> <span class="n">ele</span><span class="p">.</span><span class="n">location</span><span class="p">[</span><span class="s">'y'</span><span class="p">]</span> <span class="o">+</span> <span class="n">ele</span><span class="p">.</span><span class="n">size</span><span class="p">[</span><span class="s">'height'</span><span class="p">]</span>
<span class="c1"># æ‰“å¼€ä¹‹å‰æˆªå–çš„æ•´é¡µå›¾ç‰‡
# è¿™é‡Œç”¨åˆ°PILæ¨¡å—
</span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'quanbu.png'</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="p">.</span><span class="n">crop</span><span class="p">((</span><span class="n">left</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">110</span><span class="p">,</span> <span class="n">top</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">right</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1"># æ³¨æ„winè®¾å¤‡ä¸éœ€è¦*2
# ä¿å­˜å›¾ç‰‡
</span><span class="n">im</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'wuque_jubu.png'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="æ‰¾åˆ°å®Œæ•´å›¾ç‰‡">æ‰¾åˆ°å®Œæ•´å›¾ç‰‡ï¼š</h3>

<p>è¿™æ ·æˆ‘ä»¬å°±è·å¾—äº†å¸¦ç¼ºå£çš„å±€éƒ¨æˆªå›¾ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¦æ‰¾åˆ°å®Œæ•´çš„å›¾ç‰‡ï¼Œä¸€èˆ¬ä¸¤ä¸ªæ ‡ç­¾ä¼šç¦»çš„å¾ˆè¿‘</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># æ‰¾å‡ºæ— ç¼ºå£çš„å›¾ç‰‡
# æ‰§è¡Œjs
</span><span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">'document.getElementsByClassName("è¿™é‡Œè¾“å…¥classçš„å€¼")[0].style="display:block"'</span><span class="p">)</span>
<span class="c1"># æˆªå›¾
</span><span class="n">driver</span><span class="p">.</span><span class="n">save_screenshot</span><span class="p">(</span><span class="s">'wuque.png'</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'wuque.png'</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="p">.</span><span class="n">crop</span><span class="p">((</span><span class="n">left</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">110</span><span class="p">,</span> <span class="n">top</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">right</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1"># åŒç†ï¼ŒMac*2ï¼Œwinä¸éœ€è¦
</span><span class="n">im</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'wuque_jubu.png'</span><span class="p">)</span>
</code></pre></div></div>

<p>è¿™æ ·æˆ‘ä»¬å°±è·å¾—äº†æœ‰ç¼ºå£å’Œæ²¡æœ‰ç¼ºå£çš„ä¸¤è¯å›¾ç‰‡ï¼Œå¹¶ä¸”ä¸¤å¼ å›¾ç‰‡å¤§å°å®Œå…¨ä¸€è‡´ï¼Œæ–¹ä¾¿æˆ‘ä»¬åé¢çš„æ¯”è¾ƒ</p>

<h3 id="å®šä¹‰è®¡ç®—è·ç¦»çš„å‡½æ•°åŠåˆ¤æ–­ç›¸ä¼¼çš„å‡½æ•°">å®šä¹‰è®¡ç®—è·ç¦»çš„å‡½æ•°åŠåˆ¤æ–­ç›¸ä¼¼çš„å‡½æ•°</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># å®šä¹‰è®¡ç®—è·ç¦»çš„å‡½æ•°
</span><span class="k">def</span> <span class="nf">get_difference</span><span class="p">(</span><span class="n">image1</span><span class="p">,</span><span class="n">image2</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">image1</span><span class="p">.</span><span class="n">width</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">image1</span><span class="p">.</span><span class="n">height</span><span class="p">):</span>
      <span class="k">if</span>  <span class="n">is_similar</span><span class="p">(</span><span class="n">image1</span><span class="p">,</span><span class="n">image2</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">i</span>
<span class="c1"># å®šä¹‰åˆ¤æ–­ç›¸ä¼¼çš„å‡½æ•°
</span><span class="k">def</span> <span class="nf">is_similar</span><span class="p">(</span><span class="n">image1</span><span class="p">,</span><span class="n">image2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
  <span class="c1"># è®¡ç®—æ¯ä¸€ä¸ªç‚¹åœ¨å¯¹åº”å›¾ç‰‡ä¸­çš„rgbå€¼ï¼Œåˆ¤æ–­æ˜¯å¦ç¼ºå£
</span>  <span class="c1"># è®¡ç®—RGBå€¼çš„æ–¹æ³•
</span>  <span class="n">pixel1</span> <span class="o">=</span> <span class="n">image1</span><span class="p">.</span><span class="n">getpixel</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
  <span class="n">pixel2</span> <span class="o">=</span> <span class="n">image2</span><span class="p">.</span><span class="n">getpixel</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
  <span class="c1"># æ‰¾å‡ºç¼ºå£
</span>  <span class="c1"># éœ€è¦è®¾ç½®ä¸€ä¸ªå®¹å·®èŒƒå›´ï¼Œå¦‚æœè¶…å‡ºè¿™ä¸ªèŒƒå›´ä¸ºç¼ºå£ï¼Œå¦åˆ™ä¸æ˜¯ç¼ºå£
</span>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pixel1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">pixel2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pixel1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pixel2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pixel1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">pixel2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>
</code></pre></div></div>

<p>æ¥ä¸‹æ¥å°±è°ƒç”¨å®šä¹‰å¥½çš„å‡½æ•°æ¥è®¡ç®—ç§»åŠ¨è·ç¦»</p>

<h3 id="è®¡ç®—ç§»åŠ¨è·ç¦»">è®¡ç®—ç§»åŠ¨è·ç¦»</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">im1</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'wuque_jubu.png'</span><span class="p">)</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'quekou_jubu.png'</span><span class="p">)</span>
<span class="n">distance</span> <span class="o">=</span> <span class="n">get_difference</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">im2</span><span class="p">)</span>
</code></pre></div></div>

<p>ç„¶åæ‰¾åˆ°æ»‘å—æŒ‰é’®ï¼Œå¼€å§‹ç§»åŠ¨æ»‘å—å°±å¥½</p>

<h3 id="å¼€å§‹ç§»åŠ¨æ»‘å—">å¼€å§‹ç§»åŠ¨æ»‘å—</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">huakuai</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s">'xpathè·¯å¾„'</span><span class="p">)</span>
<span class="c1"># æŒ‰ä½æ»‘å—å¹¶ä¿æŒä¸åŠ¨
# è¿™é‡Œéœ€è¦å¯¼å…¥seleniumçš„åŠ¨ä½œé“¾
</span><span class="kn">from</span> <span class="nn">selenium.webdriver.common.action_chains</span> <span class="kn">import</span> <span class="n">ActionChains</span>

<span class="n">ActionChains</span><span class="p">(</span><span class="n">driver</span><span class="p">).</span><span class="n">click_and_hold</span><span class="p">(</span><span class="n">on_element</span><span class="o">=</span><span class="n">huakuai</span><span class="p">).</span><span class="n">perform</span><span class="p">()</span>

<span class="c1"># æ»‘åŠ¨æ»‘å—
</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">driver</span><span class="p">).</span><span class="n">move_by_offset</span><span class="p">(</span><span class="n">xoffset</span><span class="o">=</span><span class="p">(</span><span class="n">distance</span> <span class="o">+</span> <span class="mi">55</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">yoffset</span><span class="o">=</span><span class="mi">0</span><span class="p">).</span><span class="n">perform</span><span class="p">()</span>

<span class="c1"># æ¾å¼€é¼ æ ‡
</span><span class="n">ActionChains</span><span class="p">(</span><span class="n">driver</span><span class="p">).</span><span class="n">release</span><span class="p">().</span><span class="n">perform</span><span class="p">()</span>

</code></pre></div></div>

<p>ä½†æ˜¯ï¼Œç¨‹åºç§»åŠ¨æ»‘å—çš„é€Ÿåº¦æ˜¯éå¸¸å¿«çš„ï¼Œç›´æ¥å°±é—ªç°è¿‡å»äº†ï¼Œä¸€èˆ¬æ˜¯æˆåŠŸä¸äº†çš„ï¼Œæ­£å¸¸ç½‘é¡µéƒ½ä¼šæœ‰åˆ¤æ–­ï¼Œé€Ÿåº¦è¿‡å¿«æ—¶æ— æ³•é€šè¿‡çš„ï¼Œè¿™é‡Œå°±éœ€è¦ç”¨åˆ°ç‰©ç†çš„åŠ é€Ÿè¿åŠ¨äº†ï¼Œæˆ‘ä»¬è®©ç¨‹åºæ¥åšåŒ€åŠ åŒ€å‡é€Ÿè¿åŠ¨ï¼Œæœ¬äººèº«ä¸ºä¸€ä¸ªç‰©ç†é»‘æ´ï¼Œåªèƒ½æ‹¿å¤§ä½¬å®šä¹‰å¥½çš„æ¥ç”¨äº†â€¦â€¦.</p>

<h3 id="å®šä¹‰è®¡ç®—è¿åŠ¨è½¨è¿¹çš„å‡½æ•°">å®šä¹‰è®¡ç®—è¿åŠ¨è½¨è¿¹çš„å‡½æ•°</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">get_distance</span><span class="p">(</span><span class="n">distance</span><span class="p">):</span>
    <span class="s">"""
    x = v0*t + 1/2 * a * t ** 2
    v = v0 + a * t
    """</span>
    <span class="c1"># å®šä¹‰å•ä½æ—¶é—´
</span>    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="c1"># å®šä¹‰åˆé€Ÿåº¦
</span>    <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># å®šä¹‰å­˜æ”¾è¿åŠ¨è½¨è¿¹çš„å®¹å™¨
</span>    <span class="n">distance_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># å®šä¹‰åŒ€åŠ é€Ÿå’ŒåŒ€å‡é€Ÿçš„åˆ†ç•Œçº¿
</span>    <span class="n">mid</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">*</span> <span class="mf">0.8</span>
    <span class="c1"># å®šä¹‰å½“å‰ä½ç§»
</span>    <span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">current</span> <span class="o">&lt;</span> <span class="n">distance</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">current</span> <span class="o">&lt;</span> <span class="n">mid</span><span class="p">:</span>
            <span class="c1"># åŒ€åŠ é€Ÿè¿åŠ¨
</span>            <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># åŒ€å‡é€Ÿè¿åŠ¨
</span>            <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
        <span class="c1"># è®¡ç®—ä½ç§»
</span>        <span class="n">x</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">current</span> <span class="o">+=</span> <span class="n">x</span>
        <span class="c1"># è®¡ç®—æœ«é€Ÿåº¦
</span>        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">t</span>
        <span class="n">distance_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">distance_list</span>
</code></pre></div></div>

<p>ç„¶åæˆ‘ä»¬éœ€è¦åœ¨æ¾å¼€é¼ æ ‡ä¹‹å‰åŠ å…¥æ¨¡æ‹Ÿå…ˆåŠ é€Ÿåå‡é€Ÿçš„è¿åŠ¨</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># åˆ©ç”¨ç‰©ç†åŠ é€Ÿåº¦ï¼Œæ¨¡æ‹Ÿå‡ºå…ˆåŠ é€Ÿåå‡é€Ÿçš„è¿åŠ¨
</span><span class="n">distance_list</span> <span class="o">=</span> <span class="n">get_distance</span><span class="p">((</span><span class="n">distance</span> <span class="o">+</span> <span class="mi">55</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">distance_list</span><span class="p">:</span>
 <span class="n">ActionChains</span><span class="p">(</span><span class="n">driver</span><span class="p">).</span><span class="n">move_by_offset</span><span class="p">(</span><span class="n">xoffset</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">yoffset</span><span class="o">=</span><span class="mi">0</span><span class="p">).</span><span class="n">perform</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="æ€»ç»“">æ€»ç»“:</h3>

<p>è¿™å°±æ˜¯æœ¬äººæ€»ç»“çš„ç ´è§£æ»‘å—éªŒè¯ç çš„å…·ä½“æ€è·¯äº†ï¼Œä½†æ˜¯åœ¨å¾ˆå¤šç½‘ç«™éƒ½ä¼šé’ˆå¯¹è¿›è¡Œæ£€æµ‹ï¼ŒæˆåŠŸç‡è¾ƒä½ï¼Œéœ€è¦ä¸æ–­çš„å®éªŒæ¥è°ƒæ•´ç¨‹åºæ»‘åŠ¨çš„è¿åŠ¨è½¨è¿¹æ¥å‡å°‘è¢«æ£€æµ‹çš„å‡ ç‡</p>
:ET